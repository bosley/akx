(io/putf "=== Forms Matching Tests ===\n")

(io/putf "Test 1: Compound form definition\n")
(form-define :Point2D { :int :int })
(io/putf "  PASS: Compound form defined\n")

(io/putf "Test 2: Mixed compound form definition\n")
(form-define :Record { :string :int :real })
(io/putf "  PASS: Mixed compound form defined\n")

(io/putf "Test 3: Struct form definition\n")
(form-define :Person [:name :string :age :int])
(io/putf "  PASS: Struct form defined\n")

(io/putf "Test 4: List form definition\n")
(form-define :IntList (list :int))
(io/putf "  PASS: List form defined\n")

(io/putf "Test 5: Named form alias matching\n")
(form-define :UserId :int)
(let uid 1001)
(if (form-matches uid :UserId)
  (io/putf "  PASS: Named alias matches\n")
  (io/putf "  FAIL: Named alias should match\n"))

(io/putf "Test 6: Chained alias matching\n")
(form-define :PersonId :UserId)
(let pid 2002)
(if (form-matches pid :PersonId)
  (io/putf "  PASS: Chained alias matches\n")
  (io/putf "  FAIL: Chained alias should match\n"))

(io/putf "Test 7: Nil matching\n")
(form-define :NilForm :int)
(if (form-matches nil :NilForm)
  (io/putf "  FAIL: Nil should not match int\n")
  (io/putf "  PASS: Nil rejected for int\n"))

(io/putf "Test 8: Symbol matching\n")
(form-define :SymForm :int)
(if (form-matches 'mysym :SymForm)
  (io/putf "  FAIL: Symbol should not match int\n")
  (io/putf "  PASS: Symbol rejected for int\n"))

(io/putf "\n=== All Matching Tests Complete ===\n")

