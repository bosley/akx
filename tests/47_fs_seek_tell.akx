(io/putf "Test: File seek and tell operations\n\n")

(let test-file "/tmp/akx_test_seek_tell.txt")
(let test-content "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")
(fs/write-file test-file test-content)

(io/putf "Test 1: Tell initial position\n")
(let fid1 (fs/open :path test-file :mode "r"))
(let pos1 (fs/tell :fid fid1))
(io/putf "  Position: %d\n" pos1)
(fs/close :fid fid1)

(io/putf "\nTest 2: Seek to position 10 (SEEK_SET)\n")
(let fid2 (fs/open :path test-file :mode "r"))
(let pos2 (fs/seek :fid fid2 :offset 10 :whence set))
(io/putf "  New position: %d\n" pos2)
(let content2 (fs/read :fid fid2 :bytes 5))
(io/putf "  Content at position: %s\n" content2)
(fs/close :fid fid2)

(io/putf "\nTest 3: Seek relative (SEEK_CUR)\n")
(let fid3 (fs/open :path test-file :mode "r"))
(fs/read :fid fid3 :bytes 5)
(let pos3a (fs/tell :fid fid3))
(io/putf "  Position after reading 5 bytes: %d\n" pos3a)
(let pos3b (fs/seek :fid fid3 :offset 5 :whence cur))
(io/putf "  Position after seeking +5: %d\n" pos3b)
(let content3 (fs/read :fid fid3 :bytes 3))
(io/putf "  Content at position: %s\n" content3)
(fs/close :fid fid3)

(io/putf "\nTest 4: Seek from end (SEEK_END)\n")
(let fid4 (fs/open :path test-file :mode "r"))
(let pos4 (fs/seek :fid fid4 :offset -5 :whence end))
(io/putf "  Position (5 bytes from end): %d\n" pos4)
(let content4 (fs/read :fid fid4 :bytes 5))
(io/putf "  Content at position: %s\n" content4)
(fs/close :fid fid4)

(io/putf "\nTest 5: Multiple seeks\n")
(let fid5 (fs/open :path test-file :mode "r"))
(fs/seek :fid fid5 :offset 0 :whence set)
(let content5a (fs/read :fid fid5 :bytes 3))
(io/putf "  Read from start: %s\n" content5a)
(fs/seek :fid fid5 :offset 15 :whence set)
(let content5b (fs/read :fid fid5 :bytes 3))
(io/putf "  Read from position 15: %s\n" content5b)
(fs/seek :fid fid5 :offset 30 :whence set)
(let content5c (fs/read :fid fid5 :bytes 3))
(io/putf "  Read from position 30: %s\n" content5c)
(fs/close :fid fid5)

(fs/delete test-file)
(io/putf "\nTest complete.\n")

