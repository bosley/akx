(io/putf "=== Forms Advanced Affordance Tests ===\n")

(io/putf "Test 1: Affordance with no parameters\n")
(form-define :Resettable :int)
(form-add-affordance :Resettable :reset (lambda [] 0))
(io/putf "  PASS: No-parameter affordance added\n")

(io/putf "Test 2: Affordance with single parameter\n")
(form-define :Incrementable :int)
(form-add-affordance :Incrementable :inc (lambda [x] (+ x 1)))
(io/putf "  PASS: Single-parameter affordance added\n")

(io/putf "Test 3: Affordance with multiple parameters\n")
(form-define :Calculator :int)
(form-add-affordance :Calculator :add (lambda [x y] (+ x y)))
(io/putf "  PASS: Multi-parameter affordance added\n")

(io/putf "Test 4: Multiple affordances on same form\n")
(form-define :Counter :int)
(form-add-affordance :Counter :inc (lambda [x] (+ x 1)))
(form-add-affordance :Counter :dec (lambda [x] (- x 1)))
(form-add-affordance :Counter :double (lambda [x] (* x 2)))
(form-add-affordance :Counter :reset (lambda [x] 0))
(io/putf "  PASS: Four affordances added to one form\n")

(io/putf "Test 5: Affordances on different forms\n")
(form-define :Temp :real)
(form-add-affordance :Temp :to-f (lambda [c] (+ (* c 1.8) 32)))
(form-define :Distance :real)
(form-add-affordance :Distance :to-km (lambda [m] (/ m 1000.0)))
(io/putf "  PASS: Different forms with affordances\n")

(io/putf "Test 6: Affordance on compound form\n")
(form-define :Point2D { :int :int })
(form-add-affordance :Point2D :origin (lambda [] 0))
(io/putf "  PASS: Affordance on compound form\n")

(io/putf "Test 7: Affordance on struct form\n")
(form-define :Person [:name :string :age :int])
(form-add-affordance :Person :greet (lambda [p] (io/putf "Hello\n")))
(io/putf "  PASS: Affordance on struct form\n")

(io/putf "Test 8: Affordance on optional form\n")
(form-define :MaybeInt (optional :int))
(form-add-affordance :MaybeInt :unwrap (lambda [x] x))
(io/putf "  PASS: Affordance on optional form\n")

(io/putf "Test 9: Affordance on list form\n")
(form-define :IntList (list :int))
(form-add-affordance :IntList :sum (lambda [xs] 0))
(io/putf "  PASS: Affordance on list form\n")

(io/putf "Test 10: Affordance on aliased form\n")
(form-define :UserId :int)
(form-add-affordance :UserId :validate (lambda [id] 1))
(io/putf "  PASS: Affordance on aliased form\n")

(io/putf "\n=== All Advanced Affordance Tests Complete ===\n")

