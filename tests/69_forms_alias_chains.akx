(io/putf "=== Forms Alias Chain Tests ===\n")

(io/putf "Test 1: Simple alias chain\n")
(form/define :UserId :int)
(let uid 1001)
(if (form/matches uid :UserId)
  (io/putf "  PASS: Simple alias matches\n")
  (io/putf "  FAIL: Simple alias should match\n"))

(io/putf "Test 2: Two-level alias chain\n")
(form/define :PersonId :UserId)
(let pid 2002)
(if (form/matches pid :PersonId)
  (io/putf "  PASS: Two-level alias matches\n")
  (io/putf "  FAIL: Two-level alias should match\n"))

(io/putf "Test 3: Alias chain with compound form\n")
(form/define :Point { :int :int })
(form/define :Coordinate :Point)
(io/putf "  PASS: Compound alias defined\n")

(io/putf "Test 4: Alias to real type\n")
(form/define :Temperature :real)
(let temp 98.6)
(if (form/matches temp :Temperature)
  (io/putf "  PASS: Real alias matches\n")
  (io/putf "  FAIL: Real alias should match\n"))

(io/putf "Test 5: Alias to string type\n")
(form/define :Name :string)
(let name "Alice")
(if (form/matches name :Name)
  (io/putf "  PASS: String alias matches\n")
  (io/putf "  FAIL: String alias should match\n"))

(io/putf "Test 6: Multiple aliases to same base\n")
(form/define :Width :int)
(form/define :Height :int)
(let w 100)
(let h 200)
(if (and (form/matches w :Width) (form/matches h :Height))
  (io/putf "  PASS: Multiple aliases work independently\n")
  (io/putf "  FAIL: Multiple aliases should work\n"))

(io/putf "Test 7: Multiple levels work for matching\n")
(let val 999)
(if (form/matches val :PersonId)
  (io/putf "  PASS: Two-level alias still works\n")
  (io/putf "  FAIL: Two-level alias should work\n"))

(io/putf "Test 8: Cross-type alias rejection\n")
(form/define :IntType :int)
(let realval 3.14)
(if (form/matches realval :IntType)
  (io/putf "  FAIL: Real should not match int alias\n")
  (io/putf "  PASS: Real correctly rejected for int alias\n"))

(io/putf "\n=== All Alias Chain Tests Complete ===\n")

